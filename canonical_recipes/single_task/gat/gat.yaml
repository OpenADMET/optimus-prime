data:
  # Specify the dataset file
  resource: ../ChEMBL_permissive_CYP3A4_CHEMBL340_aggregated.parquet
  type: intake
  input_col: OPENADMET_SMILES
  # Specify each (1+) of the target columns, or the column that you're trying to predict
  target_cols:
  - pchembl_value_mean
  dropna: true
metadata:
  authors: Hugo M-O
  email: hugo.macdermott-opeskin@omsf.io
  biotargets:
  - CYP3A4
  build_number: 0
  description: basic regression  using a GAT model
  driver: pytorch
  name: chemprop_MT_pchembl_testing_chemprop
  tag: openadmet-CYP3A4-pchembl-regression-testing-cv
  tags:
  - openadmet
  - test
  - pchembl
  version: v1

procedure:
  split:
    type: "ShuffleSplitter"
    params:
      train_size: 0.7
      val_size: 0.1
      test_size: 0.2
      shuffle: True

  feat:
    type: "GATGraphFeaturizer"
    params: {}

  model:
    type: GATv2Model
    params:
      input_dim: 8
      edge_dim: 4
      hidden_dim: 64
      num_layers: 4
      num_heads: 8
      gat_dropout: 0.1
      pooling: "mean"
      output_dim: 1

  train:
    type: "LightningTrainer"


report:
  eval:
  - params: {}
    type: RegressionMetrics
  - params:
      axes_labels:
      - True pChEMBL
      - Predicted pChEMBL
      max_val: 10
      min_val: 3
      pXC50: true
      title: Multitask True vs Predicted pChEMBL on test set
    type: RegressionPlots
  - params:
      axes_labels:
      - True pChEMBL
      - Predicted pChEMBL
      n_repeats: 2
      n_splits: 5
      pXC50: true
      random_state: 42
      title: Multitask True vs Predicted pChEMBL on test set
    type: PytorchLightningRepeatedKFoldCrossValidation